load_module modules/ngx_http_headers_more_filter_module.so; # Chargement du module pour la gestion des headers

events { 
    worker_connections 1024;  # Nombre de connexions simultanées par worker
}

http {
    sendfile on;
    tcp_nopush on;
    types_hash_max_size 2048;

    server_tokens off;          # cache le numéro de version dans les headers
    more_set_headers 'Server';  # cache le header Server

    add_header X-XSS-Protection "1: mode=block" always; # évite les attaques XSS
    add_header X-Frame_Options "SAMEORIGIN" always;     # évite le 'clickjacking'
    add_header Permission-Policy "";                    # on utilise pas d'API
    add_header Content-Security-Policy "default-src 'self';" always;    # On précise que tout le contenu du site proviendra de la même origine. Cette option est très souvent retirée car trop restrictive.
    add_header X-Content-Type-Options "nosniff" always; # évite le 'sniffing' sur IE et Chrome


    ssl_protocols TLSv1.2 TLSv1.3;  # On accepte que les protocoles TLS récents
    ssl_prefer_server_ciphers on;   # On force l'utilisation des ciphers du serveur

    error_log /var/log/nginx/error.log notice;  # On est le plus verbose possible dans les logs

    gzip on;
}

